---
title: COMSOL Geometrical Optics接口如何导入太阳能辐射光谱
categories:
  - 软件学习
mathjax: true
translate_title: How-to-import-solar-radiation-spectrum-using-comsol-multiphysics-geometrical-interface
date: 2020-08-07 09:19:00
tags: [CAE, COMSOL, 仿真, 计算]
---

#### 问题概述

COMSOL Multiphysics 软件的几何光学（Geometrical Optics）接口同时支持单色光和复色光计算，但是这里的复色光只允许定义不同的波长以便进行光路计算。对于需要考虑功率和强度分布的情况，因为软件只能指定总的辐照强度而无法指定每个波长的辐照强度，所以并不适用于评估实际太阳光辐照的功率分布。本文主要探讨如何基于软件的现有功能，实现太阳光能量光谱的表征。

#### 太阳能光谱

太阳辐照光谱随时间和位置变化，如下图 $^{[1]}$ 所示，目前广泛采用的标准太阳能光谱是AM0（大气层外）和AM1.5（陆地），前者平均辐照强度是1366.1 $W/m^2$ ，后者为1000 $W/m^2$ 。

![](/assets/img/blogimgs/cax/optical/solar_spectra_am1.5.png)

实际数值模拟中，通常采用离散的太阳光光谱以方便计算。离散的太阳光数据曲线和实际太阳光数据曲线关系如下图 $^{[2]}$ 所示。

![](/assets/img/blogimgs/cax/optical/solar_spectrum_simu.bmp)

对于连续的波段，取其特征波长，积分可得到其辐照强度占总辐照强度的权重比，基于此，上图可以改写为如下表示形式 $^{[3]}$ 。

| 波段       | 特征波长 | 权重因子 |
| ---------- | -------- | -------- |
| 0.295-0.40 | 0.374    | 0.0267   |
| 0.40-0.43  | 0.416    | 0.0275   |
| 0.43-0.45  | 0.441    | 0.0244   |
| 0.45-0.47  | 0.460    | 0.0291   |
| 0.47-0.49  | 0.480    | 0.0320   |
| 0.49-0.51  | 0.500    | 0.0327   |
| 0.51-0.53  | 0.520    | 0.0323   |
| 0.53-0.55  | 0.540    | 0.0322   |
| 0.55-0.57  | 0.560    | 0.0319   |
| 0.57-0.60  | 0.585    | 0.0473   |
| 0.60-0.63  | 0.615    | 0.0473   |
| 0.63-0.66  | 0.645    | 0.0475   |
| 0.66-0.69  | 0.675    | 0.0456   |
| 0.69-0.73  | 0.709    | 0.0537   |
| 0.73-0.78  | 0.753    | 0.0591   |
| 0.78-0.83  | 0.804    | 0.0562   |
| 0.83-0.89  | 0.857    | 0.0623   |
| 0.89-0.99  | 0.953    | 0.0606   |
| 0.99-1.06  | 1.024    | 0.0565   |
| 1.06-1.21  | 1.129    | 0.0621   |
| 1.21-1.52  | 1.274    | 0.0649   |
| 1.52-2.20  | 1.642    | 0.0681   |

#### COMSOL表征

这个问题本身其实并不复杂，很容易想到，使用单色光模式，每个频率单独计算，辐照功率乘以每个频率下的权重因子，然后将计算结果累加到一起即可。如果频率比较少，可以直接手动操作；如果频率比较多，如本例中包含22个典型频率，手动操作就会比较麻烦而且显得不甚明智。对于较多频率的情况可以借助COMSOL with MATLAB编程实现，不过相关过程本文不做讨论，下面只给出完全基于COMSOL软件自身功能的实现过程。

1. 首先以内插函数的形式导入特征波长（ $\lambda$ ）和权重因子（ $w$ ）之间的关系： $ w=f(\lambda)$ 。

2. 同前，选用单色光模式，单色光波长为 $\lambda$ ，辐照总功率设置为 $1000w W/m^2$ 。

3. 启用参数化求解，对参数 $\lambda$ 执行扫描，参数列表参照上表，依次输入即可。

4. 求解完成后，包含所有波长和所有时间（射线追踪求解本身是含时间的瞬态分析模式）的计算结果都保存在数据集“ $sol1$ ”中。
5. 本例中对经聚光透镜汇聚的太阳光进行了计算，不同频率太阳光光路如下图所示，显示效果需要，这里仅显示了高中低三个频率。

![](/assets/img/blogimgs/cax/optical/optical_ray_trajectories_am1.5.png)

6. 接下来的结果后处理过程是本文关键，默认地用户一次只能查看特定频率和特定时间下的计算结果，如果需要对所有频率的结果求和，需要使用软件内置的一些特殊的算符 $^{[4]}$ 。本例中输入的用于后处理的表达式为： $sum(withsol('sol1',expr, setval(t,1[ns]),setind(\lambda, i)), i, 1, 22)$ 。其中， $sum$ 表示求和， $withsol$ 表示在特定的解（ $sol1$ ）中提取数值， $expr$ 是用户预期提取的变量； $setval(t,1[ns])$ 表示对 $t=1[ns]$ 时刻的结果做操作， $setind(\lambda, i)$ 配合随后的 $i, 1, 22$ 表示提取所有参数 $\lambda$ （从第1到第22个）所对应的计算结果。因为要遍历数据解，该绘图过程耗时相对较久。

7. 本例中对底部的太阳光辐照表面的光照强度进行了提取，经由上一步操作，对所有频率求和得到的光功率分布（典型的高斯光束）如下图所示。

![](/assets/img/blogimgs/cax/optical/optical_ray_trajectories_am1.5_I_cell.png)

#### Ref：

[1] Standard Solar Spectra | PVEducation[EB/OL]. [2020-08-07]. https://www.pveducation.org/pvcdrom/appendices/standard-solar-spectra.

[2] 吴贺利. 菲涅尔太阳能聚光器研究[D]. 武汉理工大学, 2010.

[3] R. Fu *et al.*, “Design of broadband SOG Fresnel lens for GaInP/GaInAs/Ge multi-junction concentrator solar cells,” Malang, East Java, Indonesia, 2014, pp. 58–62, doi: [10.1063/1.4897028](https://doi.org/10.1063/1.4897028).

[4] COMSOL, 2020. COMSOL Multiphysics reference guide (for COMSOL version 5.5,  www.comsol.com).